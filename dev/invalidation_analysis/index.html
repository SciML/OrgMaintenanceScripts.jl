<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Invalidation Analysis · OrgMaintenanceScripts.jl</title><meta name="title" content="Invalidation Analysis · OrgMaintenanceScripts.jl"/><meta property="og:title" content="Invalidation Analysis · OrgMaintenanceScripts.jl"/><meta property="twitter:title" content="Invalidation Analysis · OrgMaintenanceScripts.jl"/><meta name="description" content="Documentation for OrgMaintenanceScripts.jl."/><meta property="og:description" content="Documentation for OrgMaintenanceScripts.jl."/><meta property="twitter:description" content="Documentation for OrgMaintenanceScripts.jl."/><meta property="og:url" content="https://docs.sciml.ai/OrgMaintenanceScripts/stable/invalidation_analysis/"/><meta property="twitter:url" content="https://docs.sciml.ai/OrgMaintenanceScripts/stable/invalidation_analysis/"/><link rel="canonical" href="https://docs.sciml.ai/OrgMaintenanceScripts/stable/invalidation_analysis/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="OrgMaintenanceScripts.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">OrgMaintenanceScripts.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../formatting/">Formatting Maintenance</a></li><li><a class="tocitem" href="../version_bumping/">Version Bumping</a></li><li><a class="tocitem" href="../compat_bumping/">Compat Bumping</a></li><li><a class="tocitem" href="../min_version_fixing/">Minimum Version Fixing</a></li><li><a class="tocitem" href="../version_check_finder/">Version Check Finder</a></li><li><a class="tocitem" href="../explicit_imports_fixing/">Explicit Imports Fixing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Invalidation Analysis</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Invalidation Analysis</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/OrgMaintenanceScripts.jl/blob/main/docs/src/invalidation_analysis.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Invalidation-Analysis"><a class="docs-heading-anchor" href="#Invalidation-Analysis">Invalidation Analysis</a><a id="Invalidation-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Invalidation-Analysis" title="Permalink"></a></h1><p>The Invalidation Analysis functionality helps detect and analyze method invalidations that can significantly impact Julia package performance. This tool uses SnoopCompileCore to detect invalidations and provides detailed reports on the biggest performance problems.</p><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>Method invalidations occur when Julia needs to recompile previously compiled methods due to new method definitions. This can significantly slow down package loading and runtime performance. This module helps you:</p><ol><li>Detect invalidations in your packages</li><li>Identify the major invalidators causing the most problems</li><li>Generate comprehensive reports with actionable recommendations</li><li>Analyze entire organizations to find systemic issues</li></ol><h2 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h2><h3 id="Single-Repository-Analysis"><a class="docs-heading-anchor" href="#Single-Repository-Analysis">Single Repository Analysis</a><a id="Single-Repository-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Single-Repository-Analysis" title="Permalink"></a></h3><pre><code class="language-julia hljs">analyze_repo_invalidations(repo_path::String; test_script::String=&quot;&quot;, output_file::String=&quot;&quot;)</code></pre><p>Analyze invalidations in a single repository and generate a comprehensive report.</p><p><strong>Parameters:</strong></p><ul><li><code>repo_path</code>: Path to the repository to analyze</li><li><code>test_script</code>: Optional custom Julia code to run during analysis (defaults to loading the package and running tests)</li><li><code>output_file</code>: Optional path to save detailed JSON report</li></ul><p><strong>Returns:</strong> <code>InvalidationReport</code> object with analysis results</p><h3 id="Organization-wide-Analysis"><a class="docs-heading-anchor" href="#Organization-wide-Analysis">Organization-wide Analysis</a><a id="Organization-wide-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Organization-wide-Analysis" title="Permalink"></a></h3><pre><code class="language-julia hljs">analyze_org_invalidations(org::String; auth_token::String=&quot;&quot;, work_dir::String=mktempdir(), 
                         test_script::String=&quot;&quot;, output_dir::String=&quot;&quot;, max_repos::Int=0)</code></pre><p>Analyze invalidations across all repositories in a GitHub organization.</p><p><strong>Parameters:</strong></p><ul><li><code>org</code>: GitHub organization name</li><li><code>auth_token</code>: GitHub authentication token for API access</li><li><code>work_dir</code>: Working directory for cloning repositories</li><li><code>test_script</code>: Custom test script to run for each repository</li><li><code>output_dir</code>: Directory to save individual and summary reports</li><li><code>max_repos</code>: Maximum number of repositories to analyze (0 = no limit)</li></ul><p><strong>Returns:</strong> Dictionary mapping repository names to <code>InvalidationReport</code> objects</p><h3 id="Report-Generation"><a class="docs-heading-anchor" href="#Report-Generation">Report Generation</a><a id="Report-Generation-1"></a><a class="docs-heading-anchor-permalink" href="#Report-Generation" title="Permalink"></a></h3><pre><code class="language-julia hljs">generate_invalidation_report(repo_path::String, test_script::String=&quot;&quot;)</code></pre><p>Generate a detailed invalidation report for a repository without printing to console.</p><p><strong>Returns:</strong> <code>InvalidationReport</code> object</p><h2 id="Data-Structures"><a class="docs-heading-anchor" href="#Data-Structures">Data Structures</a><a id="Data-Structures-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Structures" title="Permalink"></a></h2><h3 id="InvalidationEntry"><a class="docs-heading-anchor" href="#InvalidationEntry">InvalidationEntry</a><a id="InvalidationEntry-1"></a><a class="docs-heading-anchor-permalink" href="#InvalidationEntry" title="Permalink"></a></h3><p>Represents a single invalidation with detailed information:</p><pre><code class="language-julia hljs">struct InvalidationEntry
    method::String          # Method signature that was invalidated
    file::String           # File where the method is defined
    line::Int              # Line number in the file
    package::String        # Package that owns the method
    reason::String         # Description of why it&#39;s problematic
    children_count::Int    # Number of methods invalidated by this one
    depth::Int            # Depth in the invalidation tree
end</code></pre><h3 id="InvalidationReport"><a class="docs-heading-anchor" href="#InvalidationReport">InvalidationReport</a><a id="InvalidationReport-1"></a><a class="docs-heading-anchor-permalink" href="#InvalidationReport" title="Permalink"></a></h3><p>Comprehensive report for a repository:</p><pre><code class="language-julia hljs">struct InvalidationReport
    repo::String                           # Repository name
    total_invalidations::Int              # Total number of invalidations
    major_invalidators::Vector{InvalidationEntry}  # Top problematic invalidations
    packages_affected::Vector{String}     # List of packages involved
    analysis_time::DateTime              # When the analysis was performed
    summary::String                      # Human-readable summary
    recommendations::Vector{String}      # Actionable recommendations
end</code></pre><h2 id="Usage-Examples"><a class="docs-heading-anchor" href="#Usage-Examples">Usage Examples</a><a id="Usage-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Usage-Examples" title="Permalink"></a></h2><h3 id="Analyze-a-Single-Repository"><a class="docs-heading-anchor" href="#Analyze-a-Single-Repository">Analyze a Single Repository</a><a id="Analyze-a-Single-Repository-1"></a><a class="docs-heading-anchor-permalink" href="#Analyze-a-Single-Repository" title="Permalink"></a></h3><pre><code class="language-julia hljs">using OrgMaintenanceScripts

# Basic analysis
report = analyze_repo_invalidations(&quot;/path/to/my/package&quot;)

# Analysis with custom test script and detailed output
custom_test = &quot;&quot;&quot;
    using MyPackage
    # Run specific operations that might cause invalidations
    MyPackage.heavy_computation()
    MyPackage.type_unstable_function([1, 2, 3])
&quot;&quot;&quot;

report = analyze_repo_invalidations(&quot;/path/to/my/package&quot;; 
    test_script=custom_test,
    output_file=&quot;invalidation_report.json&quot;
)</code></pre><h3 id="Analyze-an-Entire-Organization"><a class="docs-heading-anchor" href="#Analyze-an-Entire-Organization">Analyze an Entire Organization</a><a id="Analyze-an-Entire-Organization-1"></a><a class="docs-heading-anchor-permalink" href="#Analyze-an-Entire-Organization" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Set up GitHub authentication
github_token = ENV[&quot;GITHUB_TOKEN&quot;]

# Analyze all repositories in the SciML organization
results = analyze_org_invalidations(&quot;SciML&quot;; 
    auth_token=github_token,
    output_dir=&quot;sciml_invalidation_reports&quot;,
    max_repos=10  # Limit to first 10 repos for testing
)

# Print summary statistics
total_invalidations = sum(r.total_invalidations for r in values(results) if r.total_invalidations &gt;= 0)
println(&quot;Total invalidations across organization: $total_invalidations&quot;)</code></pre><h3 id="Custom-Analysis-Script"><a class="docs-heading-anchor" href="#Custom-Analysis-Script">Custom Analysis Script</a><a id="Custom-Analysis-Script-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-Analysis-Script" title="Permalink"></a></h3><p>For specialized analysis, you can provide custom test scripts:</p><pre><code class="language-julia hljs"># Custom script for a web framework package
web_test_script = &quot;&quot;&quot;
    using MyWebFramework
    using HTTP
    
    # Test route handling (common source of invalidations)
    app = MyWebFramework.App()
    MyWebFramework.route!(app, &quot;/test&quot;) do req
        return &quot;Hello World&quot;
    end
    
    # Test middleware chain
    MyWebFramework.use!(app, MyWebFramework.CORSMiddleware())
    MyWebFramework.use!(app, MyWebFramework.LoggingMiddleware())
&quot;&quot;&quot;

report = analyze_repo_invalidations(&quot;/path/to/web/framework&quot;; 
    test_script=web_test_script
)</code></pre><h2 id="Understanding-the-Results"><a class="docs-heading-anchor" href="#Understanding-the-Results">Understanding the Results</a><a id="Understanding-the-Results-1"></a><a class="docs-heading-anchor-permalink" href="#Understanding-the-Results" title="Permalink"></a></h2><h3 id="Summary-Interpretations"><a class="docs-heading-anchor" href="#Summary-Interpretations">Summary Interpretations</a><a id="Summary-Interpretations-1"></a><a class="docs-heading-anchor-permalink" href="#Summary-Interpretations" title="Permalink"></a></h3><ul><li>✅ <strong>0 invalidations</strong>: Excellent! Your package is well-optimized</li><li>✅ <strong>1-9 invalidations</strong>: Good performance with minor issues</li><li>⚠️ <strong>10-49 invalidations</strong>: Moderate performance impact, room for improvement</li><li>❌ <strong>50+ invalidations</strong>: Significant performance problems requiring attention</li></ul><h3 id="Major-Invalidators"><a class="docs-heading-anchor" href="#Major-Invalidators">Major Invalidators</a><a id="Major-Invalidators-1"></a><a class="docs-heading-anchor-permalink" href="#Major-Invalidators" title="Permalink"></a></h3><p>The report identifies invalidations with the highest impact based on:</p><ul><li><strong>Children Count</strong>: How many other methods this invalidation affects</li><li><strong>Package</strong>: Which package is responsible (helps prioritize fixes)</li><li><strong>Depth</strong>: Position in the invalidation tree</li></ul><h3 id="Common-Recommendations"><a class="docs-heading-anchor" href="#Common-Recommendations">Common Recommendations</a><a id="Common-Recommendations-1"></a><a class="docs-heading-anchor-permalink" href="#Common-Recommendations" title="Permalink"></a></h3><ol><li><strong>Type Stability</strong>: Ensure functions return consistent types</li><li><strong>Method Definitions</strong>: Avoid redefining methods in package loading</li><li><strong>Dependencies</strong>: Review packages that cause many invalidations</li><li><strong>Specialization</strong>: Use <code>@nospecialize</code> for arguments that don&#39;t need specialization</li></ol><h2 id="Organization-Reports"><a class="docs-heading-anchor" href="#Organization-Reports">Organization Reports</a><a id="Organization-Reports-1"></a><a class="docs-heading-anchor-permalink" href="#Organization-Reports" title="Permalink"></a></h2><p>When analyzing entire organizations, additional summary reports are generated:</p><ul><li><strong>Markdown Summary</strong>: Overview of all repositories with rankings</li><li><strong>Individual JSON Reports</strong>: Detailed data for each repository</li><li><strong>Action Items</strong>: Prioritized list of improvements</li></ul><h2 id="Best-Practices"><a class="docs-heading-anchor" href="#Best-Practices">Best Practices</a><a id="Best-Practices-1"></a><a class="docs-heading-anchor-permalink" href="#Best-Practices" title="Permalink"></a></h2><ol><li><strong>Run Early</strong>: Analyze invalidations during development, not just before release</li><li><strong>Monitor Trends</strong>: Track invalidation counts over time</li><li><strong>Focus on Impact</strong>: Prioritize fixing invalidations with high children counts</li><li><strong>Test Thoroughly</strong>: Use realistic test scripts that exercise your package&#39;s main functionality</li><li><strong>Organization Level</strong>: Run periodic organization-wide analyses to identify systemic issues</li></ol><h2 id="Integration-with-CI/CD"><a class="docs-heading-anchor" href="#Integration-with-CI/CD">Integration with CI/CD</a><a id="Integration-with-CI/CD-1"></a><a class="docs-heading-anchor-permalink" href="#Integration-with-CI/CD" title="Permalink"></a></h2><p>You can integrate invalidation analysis into your CI pipeline:</p><pre><code class="language-julia hljs"># In your CI script
using OrgMaintenanceScripts

report = analyze_repo_invalidations(&quot;.&quot;)

# Fail CI if invalidations exceed threshold
if report.total_invalidations &gt; 20
    println(&quot;❌ Too many invalidations: $(report.total_invalidations)&quot;)
    exit(1)
end

println(&quot;✅ Invalidation check passed: $(report.total_invalidations) invalidations&quot;)</code></pre><h2 id="Troubleshooting"><a class="docs-heading-anchor" href="#Troubleshooting">Troubleshooting</a><a id="Troubleshooting-1"></a><a class="docs-heading-anchor-permalink" href="#Troubleshooting" title="Permalink"></a></h2><h3 id="Common-Issues"><a class="docs-heading-anchor" href="#Common-Issues">Common Issues</a><a id="Common-Issues-1"></a><a class="docs-heading-anchor-permalink" href="#Common-Issues" title="Permalink"></a></h3><ol><li><strong>SnoopCompileCore not found</strong>: Ensure SnoopCompileCore.jl is installed</li><li><strong>Analysis fails</strong>: Check that the repository has a valid Project.toml and can be loaded</li><li><strong>Permission errors</strong>: Ensure you have read access to repositories and write access to output directories</li><li><strong>Memory issues</strong>: For large organizations, use <code>max_repos</code> to limit analysis scope</li></ol><h3 id="Performance-Considerations"><a class="docs-heading-anchor" href="#Performance-Considerations">Performance Considerations</a><a id="Performance-Considerations-1"></a><a class="docs-heading-anchor-permalink" href="#Performance-Considerations" title="Permalink"></a></h3><ul><li>Analysis runs in separate Julia processes to avoid contamination</li><li>Large organizations may take significant time to analyze</li><li>Consider running analyses on powerful machines for better performance</li><li>Use <code>max_repos</code> parameter to test on subsets first</li></ul></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Monday 28 July 2025 09:28">Monday 28 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
